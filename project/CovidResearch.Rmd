---
title: "CovidResearch"
output:
  html_document: default
  pdf_document: default
---
## Install and load Libraries
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#install.packages('plyr')
#install.packages("readr")
#install.packages("gglplot2")
library(readr)
library(ggplot2)
options(scipen=999)
```
## Import Data
```{r}
#Covid-19 Info
cov_general_data<- read_csv2("../datasets/COVID-19_aantallen_gemeente_cumulatief.csv")
cov_ic_admissions <- read_csv2("../datasets/COVID-19_ic_opnames.csv")
cov_hospital_admissions <- read_csv2("../datasets/COVID-19_ziekenhuisopnames.csv")
cov_admissions_ranked_by_age <- read_csv2("../datasets/COVID-19_ziekenhuis_ic_opnames_per_leeftijdsgroep.csv")
cov_home70 <- read_csv2("../datasets/COVID-19_thuiswonend_70plus.csv")
cov_performed_tests <- read_csv2("../datasets/COVID-19_uitgevoerde_testen.csv")
#Other info
res_count_per_province_nl <- read_csv2("../datasets/Bevolkings_aantallen_per_provincie.csv")
```
## General Research
### Covid IC Admissions
```{r}
cov_ic <- ggplot(data = cov_ic_admissions, mapping = aes(x = Date_of_statistics, y = IC_admission)) 
cov_ic_plot <- cov_ic + geom_col() + geom_smooth()
cov_ic_plot
```

### Covid Hosptial Admissions
```{r}
cov_hosp <- ggplot(data = cov_hospital_admissions, mapping = aes(x = Date_of_statistics, y = Hospital_admission))
cov_hosp_plot <- cov_hosp + geom_col()
cov_hosp_plot
```
### Covid IC Admissions by Age
```{r}
cov_ic_age <- ggplot(data = cov_admissions_ranked_by_age, mapping = aes(x = Age_group, y = IC_admission))
cov_ic_age_plot <- cov_ic_age + geom_bar(stat="identity", fill = "steelblue")
cov_ic_age_plot
```
### Covid Hospital Admissions by Age
```{r}
cov_hosp_age <- ggplot(data = cov_admissions_ranked_by_age, mapping = aes(x = Age_group, y = Hospital_admission))
cov_hosp_age_plot <- cov_hosp_age + geom_bar(stat="identity", fill = "steelblue")
cov_hosp_age_plot
```
### Total Positive Covid Test Reports Per Province Over Time
```{r}
  cov_general_data_mod <- cov_general_data
  cov_general_data_mod$Province[which(cov_general_data_mod$Province == "FryslÃ¢n")] <- "Friesland"
  cov_pos_tests_per_province <- ggplot(data = cov_general_data_mod, aes(Date_of_report, Total_reported, color = Province))
  cov_pos_tests_per_province_plot <- cov_pos_tests_per_province + geom_col()
  cov_pos_tests_per_province_plot
```
### 2021 Resident Count Per Province 
```{r}
  res_count_per_province_nl
```
### Age group at or above 70 total deceased reported
```{r}
  cov_home70_sub <- subset(cov_home70, Security_region != "Onbekend")
  cov_70 <- ggplot(data = cov_home70_sub, mapping = aes(Security_region, Total_deceased_reported))
  cov_70_plot <- cov_70 + geom_bar(stat="identity", fill = "steelblue") + coord_flip()
  cov_70_plot
```
## Regression Jamie
## Regression Glenn

<!-- I tried to make regressions of the total amount of tests performed in The Netherlands with the total amount of positives taken out from it -->

<!-- Bar plot that shows the total amount of Covid-19 tests performed in The Netherlands between 2020-06-01 and 2022-01-11 with an overlap showing the total amount of positive results per region 
  X = Amount of tests
  Y = Regions were tests have been performed
  Blue+red = Total tests per region
  Red = Total positives per region
-->

ggplot(cov_pt_sub, aes(x = Security_region_name, y = Tested_with_result)) +
  geom_col(aes(y = Tested_with_result), fill="steelblue") +
  geom_col(aes(y = Tested_positive), fill="red") + coord_flip() + geom_point(color="purple") + 
  geom_smooth(method="lm", color="green",  formula=y~x)
  
  <!-- total amount of tests performed and positive tests over the date of statistics in The Netherlands (2020-06-01 - 2021-01-11)
    X = The date of statistics
    Y = Amount of resulted tests
    Green = Amount of resulted tests per date
    Purple = Total of positives per date
  -->
  
reg1 <- ggplot(cov_pt_sub, aes(x=Date_of_statistics, y=Tested_with_result)) + 
geom_point(color="green")
reg1 <- reg1 + geom_point(aes(y=Tested_positive), color="purple", alpha=.5) + geom_smooth(method="lm", color="red", formula=y~x)
reg1

### Performed tests per region with positive result overlap (from 2020-06-01 to 2022-01-11)
```{r}
  cov_pt_sub <- subset(cov_performed_tests, Security_region_name != "Onbekend")
  cov_pt <- ggplot(cov_pt_sub, aes(Security_region_name))
  cov_pt <- cov_pt + geom_bar(aes(y = Tested_with_result), stat="identity", fill="steelblue") + coord_flip()
  cov_pt <- cov_pt + geom_bar(aes(y = Tested_positive), stat="identity", fill="red") + coord_flip()
  cov_pt
  cov_pt <- ggplot(cov_pt_sub, aes(Security_region_name)) + 
  geom_bar(aes(y = Tested_with_result), stat="identity", fill="steelblue") + coord_flip() + 
  geom_bar(aes(y = Tested_positive), stat="identity", fill="red") + coord_flip()
  cov_pt
```