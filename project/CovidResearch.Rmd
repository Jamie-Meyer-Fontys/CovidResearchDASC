---
title: "CovidResearch"
output:
  html_document: default
  pdf_document: default
---
## Install and load Libraries
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#install.packages('dplyr')
library(readr)
library(dplyr)
library(ggplot2)
library(lubridate)
options(scipen=999)
```
## Import Data
```{r}
#Covid-19 Info
cov_general_data<- read_csv2("../datasets/COVID-19_aantallen_gemeente_cumulatief.csv")
cov_general_data_daily<- read_csv2("../datasets/COVID-19_aantallen_gemeente_per_dag.csv")
cov_ic_admissions <- read_csv2("../datasets/COVID-19_ic_opnames.csv")
cov_admissions_ranked_by_age <- read_csv2("../datasets/COVID-19_ziekenhuis_ic_opnames_per_leeftijdsgroep.csv")
cov_home70 <- read_csv2("../datasets/COVID-19_thuiswonend_70plus.csv")
cov_performed_tests <- read_csv2("../datasets/COVID-19_uitgevoerde_testen.csv")
#Other info
res_count_per_province_nl <- read_csv2("../datasets/Bevolkings_aantallen_per_provincie.csv")
```
##    General Research

###   Total Positive Covid Test Reports Per Province Over Time
```{r}
  cov_general_data_mod <- cov_general_data
  cov_general_data_mod$Province[which(cov_general_data_mod$Province == "FryslÃ¢n")] <- "Friesland"
  cov_pos_tests_per_province <- ggplot(data = cov_general_data_mod, aes(Date_of_report, Total_reported, color = Province))
  cov_pos_tests_per_province_plot <- cov_pos_tests_per_province + geom_col()
  cov_pos_tests_per_province_plot
```

###   Age group at or above 70 total deceased reported
```{r}
  cov_home70_sub <- subset(cov_home70, Security_region != "Onbekend")
  cov_70 <- ggplot(data = cov_home70_sub, mapping = aes(Security_region, Total_deceased_reported))
  cov_70_plot <- cov_70 + geom_bar(stat="identity", fill = "steelblue") + coord_flip()
  cov_70_plot
```

## Regression Jamie

###   Covid IC and Hospital Admissions by Age

```{r}

cov_ic_age_sub <- subset(cov_admissions_ranked_by_age, Age_group != "Unknown");
cov_ic_age_plot <- ggplot(data = cov_ic_age_sub, mapping = aes(x = Age_group))
cov_ic_age_plot <- cov_ic_age_plot + geom_bar(aes(y = Hospital_admission ), stat="identity", fill = "steelblue") +
                  geom_bar(aes(y = IC_admission ), stat="identity", fill = "red") + coord_flip()
cov_ic_age_plot

```

## Regression Glenn

<!-- reg1 <- lm(Tested_positive ~ Tested_with_result, data = cov_performed_tests) -->
<!-- summary(reg1) -->

<!-- plot(Tested_positive ~ Tested_with_result, data = cov_performed_tests) -->
<!-- abline(reg1) -->

ggplot(cov_pt_sub, aes(x = Security_region_name, y = Tested_with_result)) + 
  geom_bar(aes(y = Tested_with_result), fill="steelblue", stat="identity") + coord_flip() + 
  geom_bar(aes(y = Tested_positive), fill="red", stat="identity") + geom_point() + 
  stat_smooth(method = "lm") 

### Performed tests per region with positive result overlap (from 2020-06-01 to 2022-01-11)
```{r}
  cov_pt_sub <- subset(cov_performed_tests, Security_region_name != "Onbekend")
  cov_pt <- ggplot(cov_pt_sub, aes(Security_region_name)) + 
  geom_bar(aes(y = Tested_with_result), stat="identity", fill="steelblue") + coord_flip() + 
  geom_bar(aes(y = Tested_positive), stat="identity", fill="red") + coord_flip()
  cov_pt
```